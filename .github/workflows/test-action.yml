name: Test CarbonCue Action

on:
  push:
    branches: [main, develop]
  pull_request:
  workflow_dispatch:

jobs:
  test-action:
    runs-on: ubuntu-latest
    name: Test Carbon-Aware Action
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Test CarbonCue Action - Hybrid Mode
        uses: ./packages/action
        with:
          mode: 'hybrid'
      
      - name: Test CarbonCue Action - Immediate Mode
        uses: ./packages/action
        with:
          mode: 'immediate'
      
      - name: Test CarbonCue Action - Defer Mode (may fail)
        continue-on-error: true
        uses: ./packages/action
        with:
          mode: 'defer'
          carbon-threshold: '100'
